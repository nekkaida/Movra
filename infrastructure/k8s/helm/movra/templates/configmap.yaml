apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "movra.fullname" . }}-config
  labels:
    {{- include "movra.labels" . | nindent 4 }}
data:
  # Service discovery
  API_GATEWAY_URL: "http://{{ include "movra.fullname" . }}-api-gateway:{{ .Values.services.apiGateway.service.port }}"
  AUTH_SERVICE_GRPC_URL: "{{ include "movra.fullname" . }}-auth-service:{{ .Values.services.authService.service.grpcPort }}"
  PAYMENT_SERVICE_GRPC_URL: "{{ include "movra.fullname" . }}-payment-service:{{ .Values.services.paymentService.service.grpcPort }}"
  EXCHANGE_RATE_SERVICE_GRPC_URL: "{{ include "movra.fullname" . }}-exchange-rate-service:{{ .Values.services.exchangeRateService.service.grpcPort }}"
  SETTLEMENT_SERVICE_GRPC_URL: "{{ include "movra.fullname" . }}-settlement-service:{{ .Values.services.settlementService.service.grpcPort }}"

  # Kafka
  KAFKA_BROKERS: "{{ .Release.Name }}-kafka:9092"

  # Redis
  REDIS_HOST: "{{ .Release.Name }}-redis-master"
  REDIS_PORT: "6379"

  # Observability
  JAEGER_ENDPOINT: "http://{{ include "movra.fullname" . }}-jaeger:14268/api/traces"
  PROMETHEUS_PUSHGATEWAY: "http://{{ include "movra.fullname" . }}-prometheus-pushgateway:9091"

  # Corridor configuration
  CORRIDORS: |
    - source: SGD
      target: PHP
      enabled: true
      fee_percentage: "0.5"
      fee_minimum: "3.00"
      margin_percentage: "0.3"
    - source: SGD
      target: INR
      enabled: true
      fee_percentage: "0.5"
      fee_minimum: "3.00"
      margin_percentage: "0.35"
    - source: SGD
      target: IDR
      enabled: true
      fee_percentage: "0.5"
      fee_minimum: "3.00"
      margin_percentage: "0.3"
    - source: USD
      target: PHP
      enabled: true
      fee_percentage: "0.4"
      fee_minimum: "2.00"
      margin_percentage: "0.25"
    - source: SGD
      target: USD
      enabled: true
      fee_percentage: "0.3"
      fee_minimum: "2.00"
      margin_percentage: "0.2"
